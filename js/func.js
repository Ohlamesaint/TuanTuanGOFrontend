var belowBar = document.querySelectorAll(".below>ul>li");
var title = document.querySelector("#title");
var middleWraps = document.querySelectorAll(".wrap>div");
var back = document.querySelector("#back");
var middleWrapRowList = document.querySelectorAll(".wrap>div>div>.row")
var headPaste = document.querySelector("#headPaste");
var mutex = true;
const tl = new TimelineMax({ repeat: -1 });

/* bluetooth var */
var file_string = "";
var over_count = 0;
var over_num = 0;
var over = 0;
var balenaBLE = new BalenaBLE();
/* bluetooth var */

tl.staggerFrom(['#block_chain > path:nth-child(1)', '#block_chain > path:nth-child(2)', '#block_chain > path:nth-child(3)', '#block_chain > path:nth-child(4)', '#block_chain > path:nth-child(5)', '#block_chain > path:nth-child(6)', '#block_chain > path:nth-child(7)', '#block_chain > path:nth-child(8)', '#block_chain > path:nth-child(9)', '#block_chain > path:nth-child(10)', '#block_chain > path:nth-child(11)', '#block_chain > path:nth-child(12)', '#block_chain > path:nth-child(13)', '#block_chain > path:nth-child(14)', '#block_chain > path:nth-child(15)', '#block_chain > path:nth-child(16)', '#block_chain > path:nth-child(17)', '#block_chain > path:nth-child(18)', '#block_chain > path:nth-child(19)', '#block_chain > path:nth-child(20)', '#block_chain > path:nth-child(21)', '#block_chain > path:nth-child(22)', '#block_chain > path:nth-child(23)', '#block_chain > path:nth-child(24)'], 0.5,
    { scaleY: 0, scaleX: 0, transformOrigin: "center", ease: Bounce.easeOut, stagger: 0.2 });
tl.staggerTo(['#block_chain > path:nth-child(1)', '#block_chain > path:nth-child(2)', '#block_chain > path:nth-child(3)', '#block_chain > path:nth-child(4)', '#block_chain > path:nth-child(5)', '#block_chain > path:nth-child(6)', '#block_chain > path:nth-child(7)', '#block_chain > path:nth-child(8)', '#block_chain > path:nth-child(9)', '#block_chain > path:nth-child(10)', '#block_chain > path:nth-child(11)', '#block_chain > path:nth-child(12)', '#block_chain > path:nth-child(13)', '#block_chain > path:nth-child(14)', '#block_chain > path:nth-child(15)', '#block_chain > path:nth-child(16)', '#block_chain > path:nth-child(17)', '#block_chain > path:nth-child(18)', '#block_chain > path:nth-child(19)', '#block_chain > path:nth-child(20)', '#block_chain > path:nth-child(21)', '#block_chain > path:nth-child(22)', '#block_chain > path:nth-child(23)', '#block_chain > path:nth-child(24)'], 0.5,
    { scaleY: 0, scaleX: 0, transformOrigin: "center", ease: Bounce.easeOut, stagger: 0.2 });
tl.pause();
let complete_list = [{
    name: "toilet",
    img: "https://www.costco.com.tw/medias/sys_master/images/h19/hd6/11953562714142.jpg",
    count: 2,
    price: 30,
    contract_address: "0x01",
    TuanGOType: 'unpack',
    TotalAmount: 12,
    SoldAmounts: 12,
    ExpirationTime: 1587743302000,
    disccountPrice: 60
}, {
    name: "wine",
    img: "https://www.costco.com.tw/medias/sys_master/images/h06/hef/16020188528670.jpg",
    count: 2,
    price: 100,
    contract_address: "0x02",
    TuanGOType: 'promote',
    TotalAmount: 5,
    SoldAmounts: 5,
    ExpirationTime: 1587513600000,
    disccountPrice: 250
}
];
let ongoing_list = [{
    name: "noodle",
    img: "https://www.costco.com.tw/medias/sys_master/images/h83/h85/27140120117278.jpg",
    count: 2,
    price: 100,
    contract_address: "0x06",
    TuanGOType: 'promote',
    TotalAmount: 12,
    SoldAmounts: 5,
    ExpirationTime: 1587743302000,
    disccountPrice: 100
}, {
    name: "cloth",
    img: "https://www.costco.com.tw/medias/sys_master/images/ha5/hbc/26500719312926.jpg",
    count: 2,
    price: 69,
    contract_address: "0x07",
    TuanGOType: 'unpack',
    TotalAmount: 2,
    SoldAmounts: 1,
    ExpirationTime: 1587743302000,
    disccountPrice: 99
}, {
    name: "brush",
    img: "https://www.costco.com.tw/medias/sys_master/images/h44/he1/14072295915550.jpg",
    count: 2,
    price: 87,
    contract_address: "0xa08",
    TuanGOType: 'unpack',
    TotalAmount: 6,
    SoldAmounts: 4,
    ExpirationTime: 1587743302000,
    disccountPrice: 87
}, {
    name: "bag",
    img: "https://www.costco.com.tw/medias/sys_master/images/hc1/hb2/10151705411614.jpg",
    count: 2,
    price: 87,
    contract_address: "0xd87",
    TuanGOType: 'promote',
    TotalAmount: 3,
    SoldAmounts: 1,
    ExpirationTime: 1587743302000,
    disccountPrice: 666
}
];
let transfer_list = [{
    name: "noodle",
    img: "https://www.costco.com.tw/medias/sys_master/images/h83/h85/27140120117278.jpg",
    count: 2,
    price: 100,
    contract_address: "0x069",
    TuanGOType: 'promote',
    TotalAmount: 12,
    SoldAmounts: 12,
    ExpirationTime: 1587743302000,
    disccountPrice: 100
}];
let information_of_transfer = [
// {
//     contract_address: "0x069",
//     date: [
//         '18-11-55', '18-11-56',
//         '18-11-57', '18-11-58',
//         '18-11-59', '18-12-0',
//         '18-12-1', '18-12-2',
//         '18-12-3', '18-12-4',
//         '18-12-5', '18-12-6',
//         '18-12-7', '18-12-8',
//         '18-12-9', '18-12-10',
//         '18-12-11', '18-12-12',
//         '18-12-13', '18-12-14',
//         '18-12-15', '18-12-16',
//         '18-12-17', '18-12-18',
//         '18-12-19', '18-12-20',
//         '18-12-21', '18-12-22',
//         '18-12-23', '18-12-24',
//         '18-12-25', '18-12-26',
//         '18-12-27', '18-12-28',
//         '18-12-29', '18-12-30',
//         '18-12-31', '18-12-32',
//         '18-12-33', '18-12-34',
//         '18-12-35', '18-12-36',
//         '18-12-37', '18-12-38',
//         '18-12-39'
//     ],
//     temperature:[
//         25, 27, 27, 27, 26, 26, 26, 29, 29, 29, 15,
//         15, 12, 12, 12, 12, 13, 10, 10, 10, 10, 10,
//         10, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
//         12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,12
//     ],
//     collision:[
//         1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0,
//         0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0,
//         0, 1, 0, 0, 1, 1, 2, 1, 1, 0, 1,
//         1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
//         0
//     ]
// },
{"contract_address":"0x01","date":["2020-4-14 15-56-8","2020-4-14 15-56-8","2020-4-14 15-56-9","2020-4-14 15-56-9","2020-4-14 15-56-9","2020-4-14 15-56-9","2020-4-14 15-56-9","2020-4-14 15-56-10","2020-4-14 15-56-10","2020-4-14 15-56-10","2020-4-14 15-56-10","2020-4-14 15-56-11","2020-4-14 15-56-11","2020-4-14 15-56-11","2020-4-14 15-56-11","2020-4-14 15-56-11","2020-4-14 15-56-12","2020-4-14 15-56-12","2020-4-14 15-56-12","2020-4-14 15-56-12","2020-4-14 15-56-13","2020-4-14 15-56-13","2020-4-14 15-56-13","2020-4-14 15-56-13","2020-4-14 15-56-13","2020-4-14 15-56-14","2020-4-14 15-56-14","2020-4-14 15-56-14","2020-4-14 15-56-14","2020-4-14 15-56-14","2020-4-14 15-56-15","2020-4-14 15-56-15","2020-4-14 15-56-15","2020-4-14 15-56-15","2020-4-14 15-56-16","2020-4-14 15-56-16","2020-4-14 15-56-16","2020-4-14 15-56-16","2020-4-14 15-56-16","2020-4-14 15-56-17","2020-4-14 15-56-17","2020-4-14 15-56-17","2020-4-14 15-56-17","2020-4-14 15-56-18","2020-4-14 15-56-18","2020-4-14 15-56-18","2020-4-14 15-56-18","2020-4-14 15-56-18","2020-4-14 15-56-19","2020-4-14 15-56-19","2020-4-14 15-56-19","2020-4-14 15-56-19","2020-4-14 15-56-19","2020-4-14 15-56-20","2020-4-14 15-56-20","2020-4-14 15-56-20","2020-4-14 15-56-20","2020-4-14 15-56-21","2020-4-14 15-56-21","2020-4-14 15-56-21","2020-4-14 15-56-21","2020-4-14 15-56-21","2020-4-14 15-56-22","2020-4-14 15-56-22","2020-4-14 15-56-22","2020-4-14 15-56-22","2020-4-14 15-56-23","2020-4-14 15-56-23","2020-4-14 15-56-23","2020-4-14 15-56-23","2020-4-14 15-56-23","2020-4-14 15-56-24","2020-4-14 15-56-24","2020-4-14 15-56-24","2020-4-14 15-56-24","2020-4-14 15-56-25","2020-4-14 15-56-25","2020-4-14 15-56-25","2020-4-14 15-56-25","2020-4-14 15-56-25","2020-4-14 15-56-26","2020-4-14 15-56-26","2020-4-14 15-56-26","2020-4-14 15-56-26","2020-4-14 15-56-27","2020-4-14 15-56-27","2020-4-14 15-56-27","2020-4-14 15-56-27","2020-4-14 15-56-27","2020-4-14 15-56-28","2020-4-14 15-56-28","2020-4-14 15-56-28","2020-4-14 15-56-28","2020-4-14 15-56-29","2020-4-14 15-56-29","2020-4-14 15-56-29","2020-4-14 15-56-29","2020-4-14 15-56-29","2020-4-14 15-56-30","2020-4-14 15-56-30","2020-4-14 15-56-30","2020-4-14 15-56-30","2020-4-14 15-56-31","2020-4-14 15-56-31","2020-4-14 15-56-31","2020-4-14 15-56-31","2020-4-14 15-56-31","2020-4-14 15-56-32","2020-4-14 15-56-32","2020-4-14 15-56-32","2020-4-14 15-56-32","2020-4-14 15-56-33","2020-4-14 15-56-33","2020-4-14 15-56-33","2020-4-14 15-56-33","2020-4-14 15-56-33","2020-4-14 15-56-34","2020-4-14 15-56-34","2020-4-14 15-56-34","2020-4-14 15-56-34","2020-4-14 15-56-35","2020-4-14 15-56-35","2020-4-14 15-56-35","2020-4-14 15-56-35","2020-4-14 15-56-35","2020-4-14 15-56-36","2020-4-14 15-56-36","2020-4-14 15-56-36","2020-4-14 15-56-36","2020-4-14 15-56-37","2020-4-14 15-56-37","2020-4-14 15-56-37","2020-4-14 15-56-37","2020-4-14 15-56-37","2020-4-14 15-56-38","2020-4-14 15-56-38","2020-4-14 15-56-38","2020-4-14 15-56-38","2020-4-14 15-56-39","2020-4-14 15-56-39","2020-4-14 15-56-39","2020-4-14 15-56-39","2020-4-14 15-56-39","2020-4-14 15-56-40","2020-4-14 15-56-40","2020-4-14 15-56-40","2020-4-14 15-56-40","2020-4-14 15-56-41","2020-4-14 15-56-41","2020-4-14 15-56-41","2020-4-14 15-56-41","2020-4-14 15-56-41","2020-4-14 15-56-42","2020-4-14 15-56-42","2020-4-14 15-56-42","2020-4-14 15-56-42","2020-4-14 15-56-42","2020-4-14 15-56-43","2020-4-14 15-56-43","2020-4-14 15-56-43","2020-4-14 15-56-43","2020-4-14 15-56-44","2020-4-14 15-56-44","2020-4-14 15-56-44","2020-4-14 15-56-44","2020-4-14 15-56-45","2020-4-14 15-56-45","2020-4-14 15-56-45","2020-4-14 15-56-45","2020-4-14 15-56-45","2020-4-14 15-56-46","2020-4-14 15-56-46","2020-4-14 15-56-46","2020-4-14 15-56-46","2020-4-14 15-56-47","2020-4-14 15-56-47","2020-4-14 15-56-47","2020-4-14 15-56-47","2020-4-14 15-56-47","2020-4-14 15-56-48","2020-4-14 15-56-48","2020-4-14 15-56-48","2020-4-14 15-56-48","2020-4-14 15-56-49","2020-4-14 15-56-49","2020-4-14 15-56-49","2020-4-14 15-56-49","2020-4-14 15-56-49","2020-4-14 15-56-50","2020-4-14 15-56-50","2020-4-14 15-56-50","2020-4-14 15-56-50","2020-4-14 15-56-51","2020-4-14 15-56-51","2020-4-14 15-56-51","2020-4-14 15-56-51","2020-4-14 15-56-51","2020-4-14 15-56-52","2020-4-14 15-56-52","2020-4-14 15-56-52","2020-4-14 15-56-52","2020-4-14 15-56-53","2020-4-14 15-56-53","2020-4-14 15-56-53","2020-4-14 15-56-53","2020-4-14 15-56-54","2020-4-14 15-56-54","2020-4-14 15-56-54","2020-4-14 15-56-54","2020-4-14 15-56-54","2020-4-14 15-56-55","2020-4-14 15-56-55","2020-4-14 15-56-55","2020-4-14 15-56-55","2020-4-14 15-56-56","2020-4-14 15-56-56","2020-4-14 15-56-56","2020-4-14 15-56-56","2020-4-14 15-56-56","2020-4-14 15-56-57","2020-4-14 15-56-57","2020-4-14 15-56-57","2020-4-14 15-56-57","2020-4-14 15-56-58","2020-4-14 15-56-58","2020-4-14 15-56-58","2020-4-14 15-56-58","2020-4-14 15-56-58","2020-4-14 15-56-59","2020-4-14 15-56-59","2020-4-14 15-56-59","2020-4-14 15-56-59","2020-4-14 15-57-0","2020-4-14 15-57-0","2020-4-14 15-57-0","2020-4-14 15-57-0","2020-4-14 15-57-0","2020-4-14 15-57-1","2020-4-14 15-57-1","2020-4-14 15-57-1","2020-4-14 15-57-1","2020-4-14 15-57-2","2020-4-14 15-57-2","2020-4-14 15-57-2","2020-4-14 15-57-2","2020-4-14 15-57-2","2020-4-14 15-57-3","2020-4-14 15-57-3","2020-4-14 15-57-3","2020-4-14 15-57-3","2020-4-14 15-57-3","2020-4-14 15-57-4","2020-4-14 15-57-4","2020-4-14 15-57-4","2020-4-14 15-57-4","2020-4-14 15-57-5","2020-4-14 15-57-5","2020-4-14 15-57-5","2020-4-14 15-57-5","2020-4-14 15-57-5","2020-4-14 15-57-6","2020-4-14 15-57-6","2020-4-14 15-57-6","2020-4-14 15-57-6","2020-4-14 15-57-7","2020-4-14 15-57-7","2020-4-14 15-57-7","2020-4-14 15-57-7","2020-4-14 15-57-7","2020-4-14 15-57-8","2020-4-14 15-57-8","2020-4-14 15-57-8","2020-4-14 15-57-8","2020-4-14 15-57-9","2020-4-14 15-57-9","2020-4-14 15-57-9","2020-4-14 15-57-9","2020-4-14 15-57-9","2020-4-14 15-57-10","2020-4-14 15-57-10","2020-4-14 15-57-10","2020-4-14 15-57-10","2020-4-14 15-57-11","2020-4-14 15-57-11","2020-4-14 15-57-11","2020-4-14 15-57-11","2020-4-14 15-57-11","2020-4-14 15-57-12","2020-4-14 15-57-12","2020-4-14 15-57-12","2020-4-14 15-57-12","2020-4-14 15-57-13","2020-4-14 15-57-13","2020-4-14 15-57-13","2020-4-14 15-57-13","2020-4-14 15-57-13","2020-4-14 15-57-14","2020-4-14 15-57-14","2020-4-14 15-57-14","2020-4-14 15-57-14","2020-4-14 15-57-15","2020-4-14 15-57-15","2020-4-14 15-57-15","2020-4-14 15-57-15","2020-4-14 15-57-15","2020-4-14 15-57-16","2020-4-14 15-57-16","2020-4-14 15-57-16","2020-4-14 15-57-16","2020-4-14 15-57-17","2020-4-14 15-57-17","2020-4-14 15-57-17","2020-4-14 15-57-17","2020-4-14 15-57-17","2020-4-14 15-57-18","2020-4-14 15-57-18","2020-4-14 15-57-18","2020-4-14 15-57-18","2020-4-14 15-57-18","2020-4-14 15-57-19","2020-4-14 15-57-19","2020-4-14 15-57-19","2020-4-14 15-57-19","2020-4-14 15-57-20","2020-4-14 15-57-20","2020-4-14 15-57-20","2020-4-14 15-57-20","2020-4-14 15-57-20","2020-4-14 15-57-21","2020-4-14 15-57-21","2020-4-14 15-57-21","2020-4-14 15-57-21","2020-4-14 15-57-22","2020-4-14 15-57-22","2020-4-14 15-57-22","2020-4-14 15-57-22","2020-4-14 15-57-22","2020-4-14 15-57-23","2020-4-14 15-57-23","2020-4-14 15-57-23","2020-4-14 15-57-23","2020-4-14 15-57-24","2020-4-14 15-57-24","2020-4-14 15-57-24","2020-4-14 15-57-24","2020-4-14 15-57-24","2020-4-14 15-57-25","2020-4-14 15-57-25","2020-4-14 15-57-25","2020-4-14 15-57-25","2020-4-14 15-57-26","2020-4-14 15-57-26","2020-4-14 15-57-26","2020-4-14 15-57-26","2020-4-14 15-57-26","2020-4-14 15-57-27","2020-4-14 15-57-27","2020-4-14 15-57-27","2020-4-14 15-57-27","2020-4-14 15-57-28","2020-4-14 15-57-28","2020-4-14 15-57-28","2020-4-14 15-57-28","2020-4-14 15-57-28","2020-4-14 15-57-29","2020-4-14 15-57-29","2020-4-14 15-57-29","2020-4-14 15-57-29","2020-4-14 15-57-29","2020-4-14 15-57-30","2020-4-14 15-57-30","2020-4-14 15-57-30","2020-4-14 15-57-30","2020-4-14 15-57-31","2020-4-14 15-57-31","2020-4-14 15-57-31","2020-4-14 15-57-31","2020-4-14 15-57-31","2020-4-14 15-57-32","2020-4-14 15-57-32","2020-4-14 15-57-32","2020-4-14 15-57-32","2020-4-14 15-57-33","2020-4-14 15-57-33","2020-4-14 15-57-33","2020-4-14 15-57-33","2020-4-14 15-57-33","2020-4-14 15-57-34","2020-4-14 15-57-34","2020-4-14 15-57-34","2020-4-14 15-57-34","2020-4-14 15-57-35","2020-4-14 15-57-35","2020-4-14 15-57-35","2020-4-14 15-57-35","2020-4-14 15-57-35","2020-4-14 15-57-36","2020-4-14 15-57-36","2020-4-14 15-57-36","2020-4-14 15-57-36","2020-4-14 15-57-36","2020-4-14 15-57-37","2020-4-14 15-57-37","2020-4-14 15-57-37","2020-4-14 15-57-37","2020-4-14 15-57-38","2020-4-14 15-57-38","2020-4-14 15-57-38","2020-4-14 15-57-38","2020-4-14 15-57-38","2020-4-14 15-57-39","2020-4-14 15-57-39","2020-4-14 15-57-39","2020-4-14 15-57-39","2020-4-14 15-57-40","2020-4-14 15-57-40","2020-4-14 15-57-40","2020-4-14 15-57-40","2020-4-14 15-57-40","2020-4-14 15-57-41","2020-4-14 15-57-41","2020-4-14 15-57-41","2020-4-14 15-57-41","2020-4-14 15-57-42","2020-4-14 15-57-42","2020-4-14 15-57-42","2020-4-14 15-57-42","2020-4-14 15-57-42","2020-4-14 15-57-43","2020-4-14 15-57-43","2020-4-14 15-57-43","2020-4-14 15-57-43","2020-4-14 15-57-44","2020-4-14 15-57-44","2020-4-14 15-57-44","2020-4-14 15-57-44","2020-4-14 15-57-44","2020-4-14 15-57-45","2020-4-14 15-57-45","2020-4-14 15-57-45","2020-4-14 15-57-45","2020-4-14 15-57-46","2020-4-14 15-57-46","2020-4-14 15-57-46","2020-4-14 15-57-46","2020-4-14 15-57-46","2020-4-14 15-57-47","2020-4-14 15-57-47","2020-4-14 15-57-47","2020-4-14 15-57-47","2020-4-14 15-57-47","2020-4-14 15-57-48","2020-4-14 15-57-48","2020-4-14 15-57-48","2020-4-14 15-57-48","2020-4-14 15-57-49","2020-4-14 15-57-49","2020-4-14 15-57-49","2020-4-14 15-57-49","2020-4-14 15-57-49"],"temperature":[7,0,5,-3,5,5,-1,5,7,-1,2,2,10,5,9,-2,0,9,8,6,0,7,0,0,4,6,-2,2,2,0,-2,1,0,4,10,6,2,-2,-1,3,8,8,2,2,10,8,6,0,2,10,-1,7,10,2,-2,9,-3,9,-3,3,4,5,-3,2,0,2,-1,4,-1,0,-2,-3,8,-1,9,-2,10,-1,-2,9,2,3,9,-3,10,5,10,-2,8,9,-1,-3,-3,5,5,-3,4,3,10,-3,-1,4,4,7,2,-2,7,9,-1,-2,2,10,2,-3,5,-1,0,-3,8,10,7,4,9,-2,4,10,4,2,0,7,6,0,7,1,2,-2,-1,4,2,-3,1,-1,8,8,2,9,-2,6,0,8,3,1,1,8,3,-2,4,9,4,6,0,-2,0,-3,0,3,10,5,-1,4,1,2,2,3,5,-1,0,10,-1,5,7,-2,3,2,-2,1,0,5,-2,10,3,8,4,0,-2,4,4,2,-3,3,2,8,4,6,-2,8,7,-1,2,4,-2,9,4,4,-1,4,-1,9,4,5,7,2,6,-1,8,-2,-2,10,0,-2,-1,3,-1,5,1,3,7,4,9,3,8,-1,6,8,-1,5,10,-1,10,6,-2,-1,8,4,2,9,2,7,-3,8,2,9,-2,0,-3,5,2,4,5,9,9,0,1,7,-1,9,2,10,1,9,4,-3,5,2,-3,-3,5,8,0,7,1,8,1,5,3,-1,2,10,6,1,-3,5,4,-2,4,-1,2,2,6,8,5,0,7,7,-2,6,-3,2,4,0,7,-3,8,6,-3,3,1,-3,2,2,8,3,1,7,8,8,-1,-2,8,7,5,6,9,10,-2,6,8,6,1,7,3,3,7,5,8,5,-3,5,9,2,4,2,6,-2,-3,0,10,10,2,-1,0,-1,7,-1,2,8,5,0,6,5,6,10,8,-1,0,0,-1,1,6,4,5,6,2,10,7,5,2,2,3,6,9,9,5,5,4,1,3,1,1,-2,3,1,7,5,2,-2,-3,7,6,0,2,9,2,10,0,8,2,0,4,2,-3,2,2,3,-2,7,7,-2,9,4,3,-1,2,4,5,7,5,4,6,1,6,3,-2,-2,8,3,7,6,0,4],"collision":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]}
,{"contract_address":"0x02","date":["2020-4-14 15-57-50","2020-4-14 15-57-50","2020-4-14 15-57-50","2020-4-14 15-57-50","2020-4-14 15-57-51","2020-4-14 15-57-51","2020-4-14 15-57-51","2020-4-14 15-57-51","2020-4-14 15-57-51","2020-4-14 15-57-52","2020-4-14 15-57-52","2020-4-14 15-57-52","2020-4-14 15-57-52","2020-4-14 15-57-53","2020-4-14 15-57-53","2020-4-14 15-57-53","2020-4-14 15-57-53","2020-4-14 15-57-53","2020-4-14 15-57-54","2020-4-14 15-57-54","2020-4-14 15-57-54","2020-4-14 15-57-54","2020-4-14 15-57-55","2020-4-14 15-57-55","2020-4-14 15-57-55","2020-4-14 15-57-55","2020-4-14 15-57-55","2020-4-14 15-57-56","2020-4-14 15-57-56","2020-4-14 15-57-56","2020-4-14 15-57-56","2020-4-14 15-57-56","2020-4-14 15-57-57","2020-4-14 15-57-57","2020-4-14 15-57-57","2020-4-14 15-57-57","2020-4-14 15-57-58","2020-4-14 15-57-58","2020-4-14 15-57-58","2020-4-14 15-57-58","2020-4-14 15-57-58","2020-4-14 15-57-59","2020-4-14 15-57-59","2020-4-14 15-57-59","2020-4-14 15-57-59","2020-4-14 15-58-0","2020-4-14 15-58-0","2020-4-14 15-58-0","2020-4-14 15-58-0","2020-4-14 15-58-0","2020-4-14 15-58-1","2020-4-14 15-58-1","2020-4-14 15-58-1","2020-4-14 15-58-1","2020-4-14 15-58-1","2020-4-14 15-58-2","2020-4-14 15-58-2","2020-4-14 15-58-2","2020-4-14 15-58-2","2020-4-14 15-58-3","2020-4-14 15-58-3","2020-4-14 15-58-3","2020-4-14 15-58-3","2020-4-14 15-58-4","2020-4-14 15-58-4","2020-4-14 15-58-4","2020-4-14 15-58-4","2020-4-14 15-58-4","2020-4-14 15-58-5","2020-4-14 15-58-5","2020-4-14 15-58-5","2020-4-14 15-58-5","2020-4-14 15-58-6","2020-4-14 15-58-6","2020-4-14 15-58-6","2020-4-14 15-58-6","2020-4-14 15-58-6","2020-4-14 15-58-7","2020-4-14 15-58-7","2020-4-14 15-58-7","2020-4-14 15-58-7","2020-4-14 15-58-8","2020-4-14 15-58-8","2020-4-14 15-58-8","2020-4-14 15-58-8","2020-4-14 15-58-8","2020-4-14 15-58-9","2020-4-14 15-58-9","2020-4-14 15-58-9","2020-4-14 15-58-9","2020-4-14 15-58-10","2020-4-14 15-58-10","2020-4-14 15-58-10","2020-4-14 15-58-10","2020-4-14 15-58-10","2020-4-14 15-58-11","2020-4-14 15-58-11","2020-4-14 15-58-11","2020-4-14 15-58-11","2020-4-14 15-58-11","2020-4-14 15-58-12","2020-4-14 15-58-12","2020-4-14 15-58-12","2020-4-14 15-58-12","2020-4-14 15-58-13","2020-4-14 15-58-13","2020-4-14 15-58-13","2020-4-14 15-58-13","2020-4-14 15-58-13","2020-4-14 15-58-14","2020-4-14 15-58-14","2020-4-14 15-58-14","2020-4-14 15-58-14","2020-4-14 15-58-15","2020-4-14 15-58-15","2020-4-14 15-58-15","2020-4-14 15-58-15","2020-4-14 15-58-15","2020-4-14 15-58-16","2020-4-14 15-58-16","2020-4-14 15-58-16","2020-4-14 15-58-16","2020-4-14 15-58-17","2020-4-14 15-58-17","2020-4-14 15-58-17","2020-4-14 15-58-17","2020-4-14 15-58-17","2020-4-14 15-58-18","2020-4-14 15-58-18","2020-4-14 15-58-18","2020-4-14 15-58-18","2020-4-14 15-58-19","2020-4-14 15-58-19","2020-4-14 15-58-19","2020-4-14 15-58-19","2020-4-14 15-58-19","2020-4-14 15-58-20","2020-4-14 15-58-20","2020-4-14 15-58-20","2020-4-14 15-58-20","2020-4-14 15-58-21","2020-4-14 15-58-21","2020-4-14 15-58-21","2020-4-14 15-58-21","2020-4-14 15-58-21","2020-4-14 15-58-22","2020-4-14 15-58-22","2020-4-14 15-58-22","2020-4-14 15-58-22","2020-4-14 15-58-23","2020-4-14 15-58-23","2020-4-14 15-58-23","2020-4-14 15-58-23","2020-4-14 15-58-23","2020-4-14 15-58-24","2020-4-14 15-58-24","2020-4-14 15-58-24","2020-4-14 15-58-24","2020-4-14 15-58-24","2020-4-14 15-58-25","2020-4-14 15-58-25","2020-4-14 15-58-25","2020-4-14 15-58-25","2020-4-14 15-58-26","2020-4-14 15-58-26","2020-4-14 15-58-26","2020-4-14 15-58-26","2020-4-14 15-58-26","2020-4-14 15-58-27","2020-4-14 15-58-27","2020-4-14 15-58-27","2020-4-14 15-58-27","2020-4-14 15-58-28","2020-4-14 15-58-28","2020-4-14 15-58-28","2020-4-14 15-58-28","2020-4-14 15-58-28","2020-4-14 15-58-29","2020-4-14 15-58-29","2020-4-14 15-58-29","2020-4-14 15-58-29","2020-4-14 15-58-30","2020-4-14 15-58-30","2020-4-14 15-58-30","2020-4-14 15-58-30","2020-4-14 15-58-30","2020-4-14 15-58-31","2020-4-14 15-58-31","2020-4-14 15-58-31","2020-4-14 15-58-31","2020-4-14 15-58-31","2020-4-14 15-58-32","2020-4-14 15-58-32","2020-4-14 15-58-32","2020-4-14 15-58-32","2020-4-14 15-58-33","2020-4-14 15-58-33","2020-4-14 15-58-33","2020-4-14 15-58-33","2020-4-14 15-58-34","2020-4-14 15-58-34","2020-4-14 15-58-34","2020-4-14 15-58-34","2020-4-14 15-58-34","2020-4-14 15-58-35","2020-4-14 15-58-35","2020-4-14 15-58-35","2020-4-14 15-58-35","2020-4-14 15-58-35","2020-4-14 15-58-36","2020-4-14 15-58-36","2020-4-14 15-58-36","2020-4-14 15-58-36","2020-4-14 15-58-37","2020-4-14 15-58-37","2020-4-14 15-58-37","2020-4-14 15-58-37","2020-4-14 15-58-37","2020-4-14 15-58-38","2020-4-14 15-58-38","2020-4-14 15-58-38","2020-4-14 15-58-38","2020-4-14 15-58-39","2020-4-14 15-58-39","2020-4-14 15-58-39","2020-4-14 15-58-39","2020-4-14 15-58-39","2020-4-14 15-58-40","2020-4-14 15-58-40","2020-4-14 15-58-40","2020-4-14 15-58-40","2020-4-14 15-58-41","2020-4-14 15-58-41","2020-4-14 15-58-41","2020-4-14 15-58-41","2020-4-14 15-58-41","2020-4-14 15-58-42","2020-4-14 15-58-42","2020-4-14 15-58-42","2020-4-14 15-58-42","2020-4-14 15-58-43","2020-4-14 15-58-43","2020-4-14 15-58-43","2020-4-14 15-58-43","2020-4-14 15-58-43","2020-4-14 15-58-44","2020-4-14 15-58-44","2020-4-14 15-58-44","2020-4-14 15-58-44","2020-4-14 15-58-45","2020-4-14 15-58-45","2020-4-14 15-58-45","2020-4-14 15-58-45","2020-4-14 15-58-45","2020-4-14 15-58-46","2020-4-14 15-58-46","2020-4-14 15-58-46","2020-4-14 15-58-46","2020-4-14 15-58-47","2020-4-14 15-58-47","2020-4-14 15-58-47","2020-4-14 15-58-47","2020-4-14 15-58-47","2020-4-14 15-58-48","2020-4-14 15-58-48","2020-4-14 15-58-48","2020-4-14 15-58-48","2020-4-14 15-58-48","2020-4-14 15-58-49","2020-4-14 15-58-49","2020-4-14 15-58-49","2020-4-14 15-58-49","2020-4-14 15-58-50","2020-4-14 15-58-50","2020-4-14 15-58-50","2020-4-14 15-58-50","2020-4-14 15-58-50","2020-4-14 15-58-51","2020-4-14 15-58-51","2020-4-14 15-58-51","2020-4-14 15-58-51","2020-4-14 15-58-52","2020-4-14 15-58-52","2020-4-14 15-58-52","2020-4-14 15-58-52","2020-4-14 15-58-52","2020-4-14 15-58-53","2020-4-14 15-58-53","2020-4-14 15-58-53","2020-4-14 15-58-53","2020-4-14 15-58-54","2020-4-14 15-58-54","2020-4-14 15-58-54","2020-4-14 15-58-54","2020-4-14 15-58-54","2020-4-14 15-58-55","2020-4-14 15-58-55","2020-4-14 15-58-55","2020-4-14 15-58-55","2020-4-14 15-58-56","2020-4-14 15-58-56","2020-4-14 15-58-56","2020-4-14 15-58-56","2020-4-14 15-58-56","2020-4-14 15-58-57","2020-4-14 15-58-57","2020-4-14 15-58-57","2020-4-14 15-58-57","2020-4-14 15-58-58","2020-4-14 15-58-58","2020-4-14 15-58-58","2020-4-14 15-58-58","2020-4-14 15-58-58","2020-4-14 15-58-59","2020-4-14 15-58-59","2020-4-14 15-58-59","2020-4-14 15-58-59","2020-4-14 15-59-0","2020-4-14 15-59-0","2020-4-14 15-59-0","2020-4-14 15-59-0","2020-4-14 15-59-0","2020-4-14 15-59-1","2020-4-14 15-59-1","2020-4-14 15-59-1","2020-4-14 15-59-1","2020-4-14 15-59-2","2020-4-14 15-59-2","2020-4-14 15-59-2","2020-4-14 15-59-2","2020-4-14 15-59-2","2020-4-14 15-59-3","2020-4-14 15-59-3","2020-4-14 15-59-3","2020-4-14 15-59-3","2020-4-14 15-59-3","2020-4-14 15-59-4","2020-4-14 15-59-4","2020-4-14 15-59-4","2020-4-14 15-59-4","2020-4-14 15-59-5","2020-4-14 15-59-5","2020-4-14 15-59-5","2020-4-14 15-59-5","2020-4-14 15-59-5","2020-4-14 15-59-6","2020-4-14 15-59-6","2020-4-14 15-59-6","2020-4-14 15-59-6","2020-4-14 15-59-7","2020-4-14 15-59-7","2020-4-14 15-59-7","2020-4-14 15-59-7","2020-4-14 15-59-7","2020-4-14 15-59-8","2020-4-14 15-59-8","2020-4-14 15-59-8","2020-4-14 15-59-8","2020-4-14 15-59-8","2020-4-14 15-59-9","2020-4-14 15-59-9","2020-4-14 15-59-9","2020-4-14 15-59-9","2020-4-14 15-59-10","2020-4-14 15-59-10","2020-4-14 15-59-10","2020-4-14 15-59-10","2020-4-14 15-59-10","2020-4-14 15-59-11","2020-4-14 15-59-11","2020-4-14 15-59-11","2020-4-14 15-59-11","2020-4-14 15-59-12","2020-4-14 15-59-12","2020-4-14 15-59-12","2020-4-14 15-59-12","2020-4-14 15-59-12","2020-4-14 15-59-13","2020-4-14 15-59-13","2020-4-14 15-59-13","2020-4-14 15-59-13","2020-4-14 15-59-14","2020-4-14 15-59-14","2020-4-14 15-59-14","2020-4-14 15-59-14","2020-4-14 15-59-14","2020-4-14 15-59-15","2020-4-14 15-59-15","2020-4-14 15-59-15","2020-4-14 15-59-15","2020-4-14 15-59-16","2020-4-14 15-59-16","2020-4-14 15-59-16","2020-4-14 15-59-16","2020-4-14 15-59-16","2020-4-14 15-59-17","2020-4-14 15-59-17","2020-4-14 15-59-17","2020-4-14 15-59-17","2020-4-14 15-59-18","2020-4-14 15-59-18","2020-4-14 15-59-18","2020-4-14 15-59-18","2020-4-14 15-59-18","2020-4-14 15-59-19","2020-4-14 15-59-19","2020-4-14 15-59-19","2020-4-14 15-59-19","2020-4-14 15-59-20","2020-4-14 15-59-20","2020-4-14 15-59-20","2020-4-14 15-59-20","2020-4-14 15-59-20","2020-4-14 15-59-21","2020-4-14 15-59-21","2020-4-14 15-59-21","2020-4-14 15-59-21","2020-4-14 15-59-22","2020-4-14 15-59-22","2020-4-14 15-59-22","2020-4-14 15-59-22","2020-4-14 15-59-22","2020-4-14 15-59-23","2020-4-14 15-59-23","2020-4-14 15-59-23","2020-4-14 15-59-23","2020-4-14 15-59-24","2020-4-14 15-59-24","2020-4-14 15-59-24","2020-4-14 15-59-24","2020-4-14 15-59-24","2020-4-14 15-59-25","2020-4-14 15-59-25","2020-4-14 15-59-25","2020-4-14 15-59-25","2020-4-14 15-59-25","2020-4-14 15-59-26","2020-4-14 15-59-26","2020-4-14 15-59-26","2020-4-14 15-59-26","2020-4-14 15-59-27","2020-4-14 15-59-27","2020-4-14 15-59-27","2020-4-14 15-59-27","2020-4-14 15-59-27","2020-4-14 15-59-28","2020-4-14 15-59-28","2020-4-14 15-59-28","2020-4-14 15-59-28","2020-4-14 15-59-29","2020-4-14 15-59-29","2020-4-14 15-59-29","2020-4-14 15-59-29","2020-4-14 15-59-29","2020-4-14 15-59-30","2020-4-14 15-59-30","2020-4-14 15-59-30","2020-4-14 15-59-30","2020-4-14 15-59-31"],"temperature":[4,7,9,17,11,7,15,11,12,9,14,7,13,6,17,10,18,11,17,4,18,14,5,5,17,16,8,15,13,12,10,9,15,8,13,9,18,7,13,15,8,6,6,17,9,10,6,18,12,9,5,6,5,12,14,7,17,9,8,10,8,15,5,16,7,12,11,9,4,14,14,11,9,16,5,9,8,4,11,5,10,16,17,16,14,5,10,7,18,16,15,14,8,10,18,16,14,18,16,4,11,7,7,17,8,5,15,13,15,15,15,13,18,5,18,11,11,8,9,6,6,12,12,17,13,4,7,16,16,11,9,17,6,15,13,12,14,14,10,17,13,14,4,9,9,5,9,12,15,17,17,8,11,15,16,6,16,5,10,16,7,18,18,10,9,10,8,9,13,5,18,4,11,15,15,14,11,12,13,6,10,10,8,5,14,8,4,17,17,12,18,16,16,17,14,17,12,6,11,11,12,15,17,12,12,15,8,5,14,6,14,15,4,14,13,6,7,17,15,13,15,8,5,7,5,13,8,8,7,15,12,9,14,15,9,4,9,13,9,14,8,15,4,11,15,15,13,13,14,12,7,10,17,16,13,14,8,7,10,14,15,9,7,14,7,10,14,18,9,8,13,10,4,5,8,6,8,17,13,9,14,17,8,9,13,10,4,8,6,7,12,9,8,9,14,11,5,18,12,13,12,10,4,11,9,18,12,6,4,9,10,7,5,8,18,8,4,9,7,5,8,13,7,12,8,13,7,14,9,5,17,15,11,12,8,4,18,18,18,7,10,12,16,12,17,18,14,17,10,18,4,14,16,17,10,18,11,13,4,12,11,15,10,6,8,13,4,8,13,16,9,15,5,12,12,6,7,4,7,6,11,14,14,9,16,11,14,16,17,9,8,17,8,16,15,17,17,17,5,5,12,10,13,6,11,18,14,12,4,17,6,10,13,16,11,6,6,12,6,17,13,12,14,12,9,13,5,4,16,14,10,16,7,9,4,18,8,17,16,5,18,9,5,13,11,12,6,7,9,11,13,18,14,5,10,10,8,17,8],"collision":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0]}
];

function t() {
    return new Promise((resolve, reject) => {
        // 傳入 resolve 與 reject，表示資料成功與失敗
        if (true) {
            setTimeout(function () {
                // 3 秒時間後，透過 resolve 來表示完成
                resolve();
            }, 3000);
        }
    })
}
$(document).ready(function () {
    var targetPage = localStorage.getItem("target");
    $(belowBar[targetPage]).addClass("actived");
    $(belowBar[targetPage]).children().addClass("actived-word");
    title.innerHTML = `
    ${belowBar[targetPage].dataset.name}
    `;
    $(middleWraps[targetPage]).siblings().removeClass("activePage");
    $(middleWraps[targetPage]).addClass("activePage");
    back.addEventListener("click", (evt) => {
        evt.preventDefault();
        window.location.replace('../main.html');
    })
    let init = middleWrapRowList[targetPage].children;
    console.log(init);
    $(init).addClass("fadeIn");


    if (targetPage == 0) {     //my profile 利用req.session來查詢並獲得
        axios({
            method: "GET",
            url: "https://tuantuango.herokuapp.com/profile",
            withCredentials: true,
        }).then(res => {

            if (!res.data.signin) {    //做保險
                console.log(res);
                console.log("789");
                setTimeout(() => {
                    window.location.replace('./login.html');
                });
            } else {

                console.log(res.data.headPaste);
                console.log(res);
                document.querySelector("#user").textContent = res.data.user;
                document.querySelector("#username").textContent = res.data.username;
                document.querySelector("#phoneNumber").textContent = res.data.phoneNumber;
                document.querySelector("#email").textContent = res.data.email;
                document.querySelector("#address").textContent = res.data.address;
                // document.querySelector("#region").textContent = res.data.username;
                var blob = new Blob([res.data.headPaste], { type: "image/jpg" });
                console.log(blob);
                var urlCreator = window.URL || window.webkitURL;
                var imageUrl = urlCreator.createObjectURL(blob);
                var reader = new FileReader();
                reader.onload = (() => {
                    console.log(reader.result);
                    var image = new Image();
                    image.src = reader.result;
                    document.body.appendChild(image);
                    // headPaste.setAttribute("style", `backgound-image: url(${reader.result})`);
                })
                reader.readAsDataURL(blob);
            }
        }).catch(err => {
            throw new Error(err);
        })
    }
    else if (targetPage == 1) {
        axios({
            method: "GET",
            url: "https://tuantuango.herokuapp.com/userTuangoList",
            withCredentials: true,
        }).then(res => {
            if (!res.data.signin) {    //做保險
                console.log(res);
                setTimeout(() => {
                    window.location.replace('./login.html');
                });
            } else {
                console.log("success");
                //console.log(res);
                var target = document.querySelector("#complete_list");
                complete_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_complete">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src="${element.img}" alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_complete">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                });
                let cardList = document.querySelectorAll('.joinlist_complete');
                for (let i = 0; i < cardList.length; i++) {
                    $(cardList[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = complete_list[i].name;
                        document.querySelector("#ProductImg").src = complete_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = complete_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(complete_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = complete_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = complete_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', complete_list[i].TotalAmount - num);
                        for (let j = 0; j < complete_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + complete_list[i].TotalAmount;
                    })
                };
                target = document.querySelector("#ongoing_list");
                ongoing_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_ongoing">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_ongoing">
                        <div class="colorgraph"></div>
                        <div class="card" data-toggle="modal" data-target="#productModal">
                        <div class="text-center" style="padding-right: 1rem;">
                        <div class="row" style="padding: 1rem;">
                            <div class="col-4">
                                <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                            </div>
                            <div class="col-8">
                                <div class="row">
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                        商品名稱
                                    </div>
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                        ${element.name}
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>  
                        </div>
                        <div class="colorgraph"></div>
                    </div>`
                    }
                })
                let cardList2 = document.querySelectorAll('.joinlist_ongoing');
                for (let i = 0; i < cardList2.length; i++) {
                    $(cardList2[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = ongoing_list[i].name;
                        document.querySelector("#ProductImg").src = ongoing_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = ongoing_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(ongoing_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = ongoing_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = ongoing_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', ongoing_list[i].TotalAmount - num);
                        for (let j = 0; j < ongoing_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + ongoing_list[i].TotalAmount;
                    })
                };
                target = document.querySelector("#transfer_list");
                transfer_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_transfer">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_transfer">
                        <div class="colorgraph"></div>
                        <div class="card" data-toggle="modal" data-target="#productModal">
                        <div class="text-center" style="padding-right: 1rem;">
                        <div class="row" style="padding: 1rem;">
                            <div class="col-4">
                                <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                            </div>
                            <div class="col-8">
                                <div class="row">
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                        商品名稱
                                    </div>
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                        ${element.name}
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>  
                        </div>
                        <div class="colorgraph"></div>
                    </div>`
                    }
                })
                let cardList3 = document.querySelectorAll('.joinlist_transfer');
                for (let i = 0; i < cardList3.length; i++) {
                    $(cardList3[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = transfer_list[i].name;
                        document.querySelector("#ProductImg").src = transfer_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = transfer_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(transfer_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = transfer_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = transfer_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', transfer_list[i].TotalAmount - num);
                        for (let j = 0; j < transfer_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + transfer_list[i].TotalAmount;
                    })
                };
            }
        }).catch(err => {
            throw new Error(err);
        })
    }
    else if (targetPage == 2) {
        axios({
            method: "GET",
            url: "https://tuantuango.herokuapp.com/userWallet",
            withCredentials: true,
        }).then(res => {
            if (!res.data.signin) {    //做保險
                console.log(res);
                setTimeout(() => {
                    window.location.replace('./login.html');
                });
            } else {
                console.log("success");
                console.log(res);
                document.querySelector("#walletCash").textContent = res.data.balance + "NT$";
                document.querySelector("#accounthere").textContent = res.data.account;
                $('#userForm').bootstrapValidator();
                tl.resume();
            }
        }).catch(err => {
            throw new Error(err);
        })
        document.querySelector("#money_send").addEventListener("click", async () => {
            if (mutex) {
                mutex = false;
                var flag = $('#userForm').data("bootstrapValidator").isValid();
                var message = document.createElement("p");
                if (flag) {
                    document.querySelector("#money_send").disabled = true;
                    message.innerText = "Wait for sending ...";
                    document.querySelector("#send_message").appendChild(message);
                    axios({
                        method: "POST",
                        url: "https://tuantuango.herokuapp.com/sendMoney",
                        withCredentials: true,
                        data: {
                            money: document.querySelector("#nn").value
                        }
                    }).then((res) => {
                        if (res.data.success == false) {
                            alert('發生錯誤，加值失敗');
                            throw new Error('send money failed');
                        }
                        alert('加值成功');
                        document.querySelector("#walletCash ").textContent = res.data.balance;
                        document.querySelector("#send_message").removeChild(message);
                        $('#store').modal('hide');
                        console.log(res);
                        document.querySelector("#money_send").disabled = false;
                    }).catch((err) => {
                        throw new Error(err);
                    })
                    console.log("send_money_post ", document.querySelector("#nn").value);
                    // await t();
                }
                else {
                    message.innerText = "Invalid Number !";
                    console.log("money error");
                }
                mutex = true;
            }
        })
    }
    else if (targetPage == 3) {
    }
    for (let i = 0; i < belowBar.length - 1; i++) {
        belowBar[i].addEventListener("click", (e) => {

            $(belowBar[i]).siblings().removeClass("actived");
            $(belowBar[i]).siblings().children().removeClass("actived-word");
            $(belowBar[i]).siblings().children().css("color", "gray");
            $(belowBar[4]).children().css("color", "rgb(145, 93, 93)");
            $(belowBar[i]).addClass("actived");
            $(belowBar[i]).children().addClass("actived-word");
            title.innerHTML = `
            ${belowBar[i].dataset.name}
            `;
            $(middleWraps[i]).siblings().removeClass("activePage");
            $(middleWraps[i]).addClass("activePage");
            document.querySelector("#complete_list").innerHTML = "";
            document.querySelector("#ongoing_list").innerHTML = "";
            document.querySelector("#transfer_list").innerHTML = "";
            for (let j = 0; j < middleWrapRowList.length; j++) {
                if (j == i) {
                    let ch = middleWrapRowList[j].children;
                    $(ch).addClass("fadeIn");
                }
                else {
                    let cs = middleWrapRowList[j].children;
                    $(cs).removeClass("fadeIn")
                }
            }
            if (i != 2) {
                tl.pause();
            }
            if (i == 0) {     //my profile 利用req.session來查詢並獲得
                axios({
                    method: "GET",
                    url: "https://tuantuango.herokuapp.com/profile",
                    withCredentials: true,
                }).then(res => {

                    if (!res.data.signin) {    //做保險
                        console.log(res);
                        console.log("789");
                        setTimeout(() => {
                            window.location.replace('./login.html');
                        });
                    } else {
                        console.log("success");
                        console.log(res);
                        document.querySelector("#user").textContent = res.data.user;
                        document.querySelector("#username").textContent = res.data.username;
                        document.querySelector("#phoneNumber").textContent = res.data.phoneNumber;
                        document.querySelector("#email").textContent = res.data.email;
                        document.querySelector("#address").textContent = res.data.address;
                        // document.querySelector("#region").textContent = res.data.username;
                        var blob = new Blob(res.data.headPaste, { type: "image/jpg" });
                        var urlCreator = window.URL || window.webkitURL;
                        var imageUrl = urlCreator.createObjectURL(blob);
                        headPaste.setAttribute("style", `backgound-image: url(${imageUrl})`);
                    }
                }).catch(err => {
                    throw new Error(err);
                })
            }
            else if (i == 2) {
                axios({
                    method: "GET",
                    url: "https://tuantuango.herokuapp.com/userWallet",
                    withCredentials: true,
                }).then(res => {
                    if (!res.data.signin) {    //做保險
                        console.log(res);
                        setTimeout(() => {
                            window.location.replace('./login.html');
                        });
                    } else {
                        console.log("success");
                        console.log(res);
                        document.querySelector("#walletCash").textContent = res.data.balance + "NT$";
                        document.querySelector("#accounthere").textContent = res.data.account;
                        $('#userForm').bootstrapValidator();
                        tl.resume();
                    }
                }).catch(err => {
                    throw new Error(err);
                })
                document.querySelector("#money_send").addEventListener("click", async () => {
                    if (mutex) {
                        var flag = $('#userForm').data("bootstrapValidator").isValid();
                        var message = document.createElement("p");
                        if (flag) {
                            document.querySelector("#money_send").disabled = true;
                            message.innerText = "Wait for sending ...";
                            document.querySelector("#send_message").appendChild(message);
                            axios({
                                method: "POST",
                                url: "https://tuantuango.herokuapp.com/sendMoney",
                                withCredentials: true,
                                data: {
                                    money: document.querySelector("#nn").value
                                }
                            }).then((res) => {
                                if (res.data.success == false) {
                                    alert('發生錯誤，加值失敗');
                                    throw new Error('send money failed');
                                }
                                alert('加值成功');
                                document.querySelector("#walletCash ").textContent = res.data.balance;
                                document.querySelector("#send_message").removeChild(message);
                                $('#store').modal('hide');
                                console.log(res);
                                document.querySelector("#money_send").disabled = false;
                            }).catch((err) => {
                                throw new Error(err);
                            })
                            console.log("send_money_post ", document.querySelector("#nn").value);
                            // await t();
                        }
                        else {
                            message.innerText = "Invalid Number !";
                            console.log("money error");
                        }
                        mutex = true;
                    }
                })
            }
            else if (i == 1) {
                /*
                axios({
                    method: "GET",
                    url: "https://tuantuango.herokuapp.com/userTuangoList",
                    withCredentials: true,
                }).then(res=>{
                    if(!res.data.signin){    //做保險
                        console.log(res);
                        console.log("789");
                        setTimeout(() => {
                            window.location.replace('./login.html');
                        }, );
                    }else{
                        
                    }
                }).catch(err=>{
                    throw new Error(err);
                })
                */
                console.log("success");
                //console.log(res);
                var target = document.querySelector("#complete_list");
                var inx = 0;
                complete_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_complete">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src="${element.img}" alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_complete">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                });
                let cardList = document.querySelectorAll('.joinlist_complete');
                for (let i = 0; i < cardList.length; i++) {
                    $(cardList[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = complete_list[i].name;
                        document.querySelector("#ProductImg").src = complete_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = complete_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(complete_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = complete_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = complete_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', complete_list[i].TotalAmount - num);
                        for (let j = 0; j < complete_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + complete_list[i].TotalAmount;
                        var info = document.querySelector('#JoinTuanGOProductInformation');
                        if(!document.getElementById('canvas')){
                            info.innerHTML += `<div class="card-header" id ="transfer_information" style="color: rgb(145, 93, 93)" >配送資訊</div>
								<canvas id="canvas" width="300" height="300">Sorry, your browser doesn't support the &lt;canvas&gt; element.</canvas>
                            `;
                        }
                        
                        var contract_address = document.querySelector('#JoinTuanGOContractAddress');
                        plt(contract_address.textContent,1);
                    })
                };
                target = document.querySelector("#ongoing_list");
                ongoing_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_ongoing">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_ongoing">
                        <div class="colorgraph"></div>
                        <div class="card" data-toggle="modal" data-target="#productModal">
                        <div class="text-center" style="padding-right: 1rem;">
                        <div class="row" style="padding: 1rem;">
                            <div class="col-4">
                                <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                            </div>
                            <div class="col-8">
                                <div class="row">
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                        商品名稱
                                    </div>
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                        ${element.name}
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>  
                        </div>
                        <div class="colorgraph"></div>
                    </div>`
                    }

                })
                let cardList2 = document.querySelectorAll('.joinlist_ongoing');
                for (let i = 0; i < cardList2.length; i++) {
                    $(cardList2[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = ongoing_list[i].name;
                        document.querySelector("#ProductImg").src = ongoing_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = ongoing_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(ongoing_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = ongoing_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = ongoing_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', ongoing_list[i].TotalAmount - num);
                        for (let j = 0; j < ongoing_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + ongoing_list[i].TotalAmount;
                    })
                };
                target = document.querySelector("#transfer_list");
                transfer_list.forEach(function (element, idx, array) {
                    if (idx === array.length - 1) {
                        target.innerHTML += `<div style="margin-bottom:6rem;" class = "joinlist_transfer">
                            <div class="colorgraph"></div>
                            <div class="card" data-toggle="modal" data-target="#productModal">
                            <div class="text-center" style="padding-right: 1rem;">
                            <div class="row" style="padding: 1rem;">
                                <div class="col-4">
                                    <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                                </div>
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                            商品名稱
                                        </div>
                                        <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                            ${element.name}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>  
                            </div>
                            <div class="colorgraph"></div>
                        </div>`
                    }
                    else {
                        target.innerHTML += `<div class="mb-4 joinlist_transfer">
                        <div class="colorgraph"></div>
                        <div class="card" data-toggle="modal" data-target="#productModal">
                        <div class="text-center" style="padding-right: 1rem;">
                        <div class="row" style="padding: 1rem;">
                            <div class="col-4">
                                <img class="img-fluid w-100 h-100" src=${element.img} alt="card image">
                            </div>
                            <div class="col-8">
                                <div class="row">
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center bd-highlight border bg-light" style="line-height: normal;">
                                        商品名稱
                                    </div>
                                    <div class="col-12 h-50 p-1 text-center justify-content-center align-items-center" style="line-height: normal;">
                                        ${element.name}
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>  
                        </div>
                        <div class="colorgraph"></div>
                    </div>`
                    }
                })
                let cardList3 = document.querySelectorAll('.joinlist_transfer');
                for (let i = 0; i < cardList3.length; i++) {
                    $(cardList3[i]).on('click', (e) => {      //注意id綁定不包含0x
                        e.preventDefault();
                        document.querySelector("#JoinTuanGOProductName").textContent = transfer_list[i].name;
                        document.querySelector("#ProductImg").src = transfer_list[i].img;
                        document.querySelector("#JoinTuanGOTuanGOType").textContent = transfer_list[i].TuanGOType ? 'unpack' : 'promote';
                        document.querySelector("#JoinTuanGOExpirationDate").textContent = new Date(transfer_list[i].ExpirationTime).toString().slice(0, 24);
                        document.querySelector("#JoinTuanGOCost").textContent = `${complete_list[i].disccountPrice} $ /per , 你買了 ${complete_list[i].count} 件`;
                        document.querySelector("#JoinTuanGOContractAddress").textContent = transfer_list[i].contract_address;
                        var num = 0;
                        var TuanGOerLine = "";
                        num = transfer_list[i].SoldAmounts;
                        localStorage.setItem('unsoldProductAmount', transfer_list[i].TotalAmount - num);
                        for (let j = 0; j < transfer_list[i].TotalAmount; j++) {
                            if (j < num) TuanGOerLine += '<i class="fas fa-user"></i>';
                            else TuanGOerLine += '<i class="far fa-user"></i>';
                        }
                        document.querySelector("#JoinTuanGOTuanGOerLine").innerHTML = TuanGOerLine + ' ' + num + '/' + transfer_list[i].TotalAmount;
                        document.querySelector("#bluetooth").disabled = false;
                    })
                };
            }
        }, false)
    }
})
if (!document.getElementById("modal_close").onclick) {
    // event undefined
    document.querySelector("#modal_close").addEventListener("click", () => {
        document.querySelector("#bluetooth").disabled = true;
        document.querySelector("#complete_list").innerHTML = "";
        document.querySelector("#ongoing_list").innerHTML = "";
        document.querySelector("#transfer_list").innerHTML = "";
        try {document.getElementById('transfer_information').remove()}catch{};
        try {document.getElementById('canvas').remove();}catch{};
        try{document.getElementById('deny_button').remove();}catch{};
        belowBar[1].click();
    });
}

//document.querySelector("#bluetooth").addEventListener("click", () => {
document.querySelector("#bluetooth").addEventListener("click", async event => {
    try {
        await balenaBLE.request();
        await balenaBLE.connect();
        await balenaBLE.setLedCharacteristic();
        await balenaBLE.setDeviceCharacteristic();
        
        read_count(); // get data
    } 
    catch (error) {
        console.log(error.message);
    }


    var bt = document.querySelector("#bluetooth");
    bt.disabled = true;
    var loading = document.createElement('i');
    loading.className = 'fa fa-spinner fa-spin';
    bt.appendChild(loading);
    setTimeout(function () {
        bt.removeChild(loading);
        bt.remove();
        var foot = document.getElementById("foot");
        var confirm = document.createElement("button");
        confirm.innerText = '確認收貨';
        confirm.className = 'btn btn-primary justify-content-start';
        confirm.id = 'confirm_button';
        confirm.addEventListener("click",event => {
            setTimeout(function () {
                document.getElementById("confirm_button").remove();
                document.querySelector("#modal_close").click();
            },1000);
        });
        foot.prepend(confirm);
        var info = document.querySelector('#JoinTuanGOProductInformation');
        if(!document.getElementById('canvas')){
            info.innerHTML += `<div class="card-header" id ="transfer_information" style="color: rgb(145, 93, 93)" >配送資訊</div>
            <canvas id="canvas" width="300" height="300">Sorry, your browser doesn't support the &lt;canvas&gt; element.</canvas>
            `;
        }
        var deny_bt = document.createElement("button");
        deny_bt.className = 'btn btn-danger';
        deny_bt.id = 'deny_button';
        var t=document.createTextNode("拒收");
        deny_bt.appendChild(t);
        info.append(deny_bt);
        //<button type="button" class="btn btn-danger">拒收</button>
        deny_bt.addEventListener("click", () => {
            deny_bt.disabled = true;
            console.log("拒收並退款");
            console.log(document.querySelector("#JoinTuanGOCost").textContent);
            var str = document.querySelector("#JoinTuanGOCost").textContent;
            var tmp = str.split(" ");
            axios({
                method: "POST",
                url: "https://tuantuango.herokuapp.com/sendMoney",
                withCredentials: true,
                data: {
                    money: tmp[0]*tmp[5]
                }
            }).then((res) => {
                if (res.data.success == false) {
                    alert('發生錯誤，退款失敗');
                    throw new Error('send money failed');
                }
                alert('拒收並退款成功');
                document.getElementById("modal_close").click();
                console.log(res);
            }).catch((err) => {
                throw new Error(err);
            })
            console.log("send_money_post ",tmp[0]*tmp[5]);
        });
        // var contract_address = document.querySelector('#JoinTuanGOContractAddress');
        // plt(contract_address.textContent,0);
    }, 3000);
});
function plt(contract_address,type) {
    console.log(contract_address);
    var ctx = document.getElementById("canvas");
    var find = information_of_transfer.find(e => e.contract_address == contract_address);
    if(!find){
        console.log("沒有此商品的運送資料");
    }
    var line = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: find.date,//date
            datasets: [
                {
                    label: '碰撞',
                    data:find.collision,//碰撞
                    order: 1,
                    borderColor: "red",
                    backgroundColor: 'red'
                }
                , {
                    type: 'line',
                    data: find.temperature,//溫度
                    label: "溫度",
                    borderColor: "#3e95cd",
                    fill: false,
                    order: 2
                }
            ]

        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'World population per region (in millions)'
            }
        }
    });
    if(type === 0){
        var findindex = transfer_list.findIndex(e => e.contract_address == contract_address);
        complete_list.push(transfer_list[findindex]);
        transfer_list.splice(findindex,1);
    }
}


//bluetooth function

function handleLedStatusChanged(event) {
    //let status = event.target.value.getUint8(1);
    var textDecorder = new TextDecoder('utf-8');
    let json_string = textDecorder.decode(event.target.value);
    console.log(json_string);
    console.log(event.target);
    if(over == 0){
      console.log(json_string);
      over_num = parseInt(json_string, 10);
      over = 1;
      if(over_count < over_num){
        over_count += 1;
        read_repeat();
      }
    }
    else{
      if(over_count < over_num){
        over_count += 1;
        read_repeat();
        file_string += json_string;
        
      }
      else if(over_count == over_num){
        file_string += json_string;
        console.log(file_string);
        file_string = JSON.parse(file_string);
        console.log(file_string[0]["time"]);
        var data_len = Object.keys(file_string).length
        var data_time = [];
        var data_collision = [];
        var data_temperature = [];
        for(let data_count = 0; data_count < data_len; data_count++){
            data_time.push(file_string[data_count]["time"]);
            data_collision.push(file_string[data_count]["collision"]);
            data_temperature.push(file_string[data_count]["temperature"]);
        }

        var contract_address = document.querySelector('#JoinTuanGOContractAddress');
        var data_push = {
            contract_address: contract_address.textContent,
            date: data_time,
            temperature: data_temperature,
            collision: data_collision
        }

        information_of_transfer.push(data_push);
        console.log(information_of_transfer);

        plt(contract_address.textContent,0);
      }
    }
}

/* helper function to decode message sent from peripheral */
function decode(buf) {
    let dec = new TextDecoder("utf-8");
    return dec.decode(buf);
}

/* Disconnect from peripheral and update UI */
function disconnect() {
    balenaBLE.disconnect();
}

async function read_count(){
    balenaBLE.readLed();
}

async function read_repeat(){
    console.log(over_num);
    balenaBLE.readLed();
}